# 简单聊天室(smallchat)

​        TLDR: 这只是我几个朋友的编程例子。我在我的YouTube频道上上传了一个视频，[zooming into the code](https://www.youtube.com/watch?v=eT02gzeLmF0)，看看可以从一个如此简单和破碎(故意)的例子中学到什么。更多的视频和改进将紧随其后，请参阅本自述文件的末尾。

现在，完整的故事:

​        昨天我和我的几个朋友聊天，他们大多是前端开发人员，他们离系统编程有点远。我们回忆起IRC的旧时光。我不可避免地说:编写一个非常简单的IRC服务器是每个人都应该做的体验(我向他们展示了我用TCL编写的实现;我很震惊，我在18年前写了这本书:时间过得真快。在这样一个程序中有非常有趣的部分。单个进程进行多路复用，获取客户端状态并在客户端有新数据时尝试快速访问该状态，等等。

​        但是随着讨论的深入，我想，我会给你们展示一个用c语言写的最小的例子。你能写的最小的聊天服务器是什么?对于初学者来说，要真正做到最小，我们不应该要求任何合适的客户端。即使不是很好，它也应该与telnet或nc (netcat)一起工作。服务器的主要操作只是接收一些聊天线并将其发送给所有其他客户机，这有时被称为扇形输出操作。然而，这需要一个合适的readline()函数，然后是缓冲，等等。我们希望它更简单:让我们使用内核缓冲区来欺骗，并假装我们每次都从客户端接收到完整格式的行(这个假设在实践中通常是正确的，所以事情有点正常)。

​         通过这些技巧，我们甚至可以实现一个让用户在200行代码中设置nick的聊天功能(当然，删除空格和注释)。因为我写了这个小程序作为我朋友的一个例子，我决定把它也推送到GitHub上。



# 未来的工作：

​        在接下来的几天里，我将继续修改这个程序以使其发展。不同的进化步骤将根据我的撰写系统软件系列的YouTube片段进行标记，该系列涵盖了这些变化。这是我的计划(可能会改变，但或多或少这是我想要讨论的内容):

* 为读写实现缓冲。

* 避免线性数组，

* 使用字典数据结构来保存客户端状态。

* 编写一个合适的客户端:行编辑能够处理异步事件。

* 实施渠道。

* 从select(2)切换到更高级的api。用于聊天的简单对称加密。

  不同的变化将被一个或多个YouTube视频覆盖。完整的提交历史记录将保存在此存储库中。
